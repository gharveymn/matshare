CMAKE_MINIMUM_REQUIRED(VERSION 3.7)
PROJECT(matshare)

SET(MEX_FILE_NAME matshare_)

INCLUDE_DIRECTORIES(${MATLAB_INCLUDE_DIR})
SET(BOOST_DIR "C:/local/boost/")
SET(BOOST_LIB "${BOOST_DIR} stage/lib/")

SET(SOURCE_FILES
		${MATLAB_INCLUDE_DIR}/mex.h
		extlib/mman-win32/mman.c extlib/mman-win32/mman.h
	   MatShare.cpp headers/MatShare.hpp headers/SharedMemStack.hpp
		)

ADD_LIBRARY(${MEX_FILE_NAME} SHARED ${SOURCE_FILES} ${CMAKE_SOURCE_DIR}/Matlabdef.def)

INCLUDE_DIRECTORIES(${BOOST_DIR})
LINK_DIRECTORIES(${MEX_FILE_NAME} ${BOOST_LIB})
TARGET_LINK_LIBRARIES(${MEX_FILE_NAME} ${MATLAB_MEX_LIBRARY} ${MATLAB_MX_LIBRARY})

INSTALL(TARGETS ${MEX_FILE_NAME} DESTINATION ${INSTALL_OUTPUT_PATH})
